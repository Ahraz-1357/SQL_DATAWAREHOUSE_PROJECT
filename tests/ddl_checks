/* check for the null and the duplicates expectation no result */
SELECT  
cst_id,
count(*)
FROM bronze.crm_cust_info
group by cst_id
having count(*)>1 OR cst_id IS NULL

/*check for unwanted spaces */
SELECT cst_firstname from bronze.crm_cust_info
WHERE cst_firstname != TRIM(cst_firstname);/*here i git those names where which contain spaces */

SELECT cst_lastname from bronze.crm_cust_info
WHERE cst_lastname != TRIM(cst_lastname);/*here i git those names where which contain spaces */

GO
SELECT cst_gndr from bronze.crm_cust_info
WHERE cst_gndr != TRIM(cst_gndr);
GO
SELECT cst_material_status from bronze.crm_cust_info
WHERE cst_material_status != TRIM(cst_material_status)

/*DATA STANDARDIZATIONAND CONSISTENCY */
SELECT DISTINCT cst_gndr
FROM bronze.crm_cust_info;

SELECT DISTINCT cst_material_status
FROM bronze.crm_cust_info;

/* ----------------end of crm_cust_info--------------------------*/
SELECT * FROM bronze.crm_prd_info;

/*prd_id check for null or duplicate values */
SELECT  
prd_id,
count(*) duplicates
FROM bronze.crm_prd_info
group by prd_id
having count(*)>1 OR prd_id IS NULL
/* check fro empty spaces*/
SELECT prd_nm from bronze.crm_prd_info
WHERE prd_nm != TRIM(prd_nm);
SELECT prd_cost from bronze.crm_prd_info
WHERE prd_cost <0 or prd_cost IS NULL;

SELECT DISTINCT prd_line
from bronze.crm_prd_info;
/*Check for invalid date orders */
SELECT *
FROM bronze.crm_prd_info
WHERE prd_end_dt<prd_start_dt;
/*---------------------------------------------------------------*/
/* crm_sales_details*/

SELECT *FROM bronze.crm_sales_details
WHERE (sls_ord_num)!=TRIM(sls_ord_num);
-- invalid date orders 
SELECT 
NULLIF(sls_order_dt,0) sls_order_dt
FROM bronze.crm_sales_details
WHERE sls_order_dt<=0 or LEN(sls_order_dt)!=8;

/*check for invalid date orders like order date should be less than ship date*/
SELECT *
FROM bronze.crm_sales_details
WHERE sls_order_dt>sls_ship_dt or sls_order_dt>sls_due_dt ;

/*check data consoistenct  between sales ,quality and price 
sales=q*price
values must noy be null,0 or -ve*/
select distinct
sls_sales AS old_sls_sales,
sls_quantity AS old_sls_quantity,
sls_price AS old_sls_price,
CASE WHEN sls_sales IS NULL OR  sls_sales <=0 or sls_sales != sls_quantity*ABS(sls_price)
		THEN sls_quantity*ABS(sls_price)
	 ELSE sls_sales	
END sls_sales,

CASE WHEN sls_price IS NULL OR sls_price <=0
	 then sls_sales /NULLIF(sls_quantity,0)
	 ELSE sls_price
END sls_price
from bronze.crm_sales_details
WHERE sls_sales != sls_quantity * sls_price
or sls_sales IS NULL  or  sls_quantity IS NULL  or sls_price  IS NULL
or sls_sales<=0 or sls_quantity<=0 or sls_price<=0
ORDER BY sls_sales,sls_quantity,sls_price

/*********-------------------erp_cust_az12-------*****************/


SELECT * FROM bronze.erp_cust_az12;
/*identify out of range dates */
SELECT *
FROM bronze.erp_cust_az12
WHERE bdate <'1924-01-01' and bdate > GETDATE()
/* check for variety in genders*/
SELECT DISTINCT gen FROM bronze.erp_cust_az12;


/*-----------------------------------erp_loc_a101---------------------------*/


SELECT *
FROM bronze.erp_loc_a101;


SELECT DISTINCT cntry as old_cntry,
CASE WHEN TRIM(cntry) IN ('USA','US') THEN 'United States'
	 WHEN TRIM(cntry) = 'DE' THEN 'Germany'
	 WHEN TRIM(cntry) = '' or cntry IS NULL THEN 'n/a'
	 ELSE TRIM(cntry)
END cntry
FROM bronze.erp_loc_a101
ORDER BY cntry 
/*-------------------------------------erp_px_cat_g1v2--------------------------*/
SELECT *
FROM bronze.erp_px_cat_g1v2;

-- chenck fro unwanted spaces 
SELECT *
FROM bronze.erp_px_cat_g1v2
WHERE cat != TRIM(cat)

SELECT *
FROM bronze.erp_px_cat_g1v2
WHERE subcat != TRIM(subcat)

SELECT DISTINCT maintenance
FROM bronze.erp_px_cat_g1v2;


SELECT DISTINCT subcat
FROM bronze.erp_px_cat_g1v2;

SELECT DISTINCT cat
FROM bronze.erp_px_cat_g1v2;
SELECT *
FROM bronze.erp_px_cat_g1v2
WHERE maintenance != TRIM(maintenance)
